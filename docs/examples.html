<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Examples | ggplot2 for ocean data</title>
  <meta name="description" content="A short overview and guide to plotting common ocean data using ggplot2." />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Examples | ggplot2 for ocean data" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A short overview and guide to plotting common ocean data using ggplot2." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Examples | ggplot2 for ocean data" />
  
  <meta name="twitter:description" content="A short overview and guide to plotting common ocean data using ggplot2." />
  

<meta name="author" content="Hansen Johnson" />


<meta name="date" content="2020-06-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="getting-started.html"/>
<link rel="next" href="conclusions.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">ggplot2 for ocean data</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#what-is-ggplot2"><i class="fa fa-check"></i><b>2.1</b> What is <strong>ggplot2</strong>?</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#data"><i class="fa fa-check"></i><b>2.2</b> Data</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#aesthetics"><i class="fa fa-check"></i><b>2.3</b> Aesthetics</a></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#geometries"><i class="fa fa-check"></i><b>2.4</b> Geometries</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>3</b> Getting started</a><ul>
<li class="chapter" data-level="3.1" data-path="getting-started.html"><a href="getting-started.html#plotting"><i class="fa fa-check"></i><b>3.1</b> Plotting</a></li>
<li class="chapter" data-level="3.2" data-path="getting-started.html"><a href="getting-started.html#formatting"><i class="fa fa-check"></i><b>3.2</b> Formatting</a><ul>
<li class="chapter" data-level="3.2.1" data-path="getting-started.html"><a href="getting-started.html#labels"><i class="fa fa-check"></i><b>3.2.1</b> Labels</a></li>
<li class="chapter" data-level="3.2.2" data-path="getting-started.html"><a href="getting-started.html#scales"><i class="fa fa-check"></i><b>3.2.2</b> Scales</a></li>
<li class="chapter" data-level="3.2.3" data-path="getting-started.html"><a href="getting-started.html#theme"><i class="fa fa-check"></i><b>3.2.3</b> Theme</a></li>
<li class="chapter" data-level="3.2.4" data-path="getting-started.html"><a href="getting-started.html#putting-it-all-together"><i class="fa fa-check"></i><b>3.2.4</b> Putting it all together</a></li>
<li class="chapter" data-level="3.2.5" data-path="getting-started.html"><a href="getting-started.html#saving"><i class="fa fa-check"></i><b>3.2.5</b> Saving</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="examples.html"><a href="examples.html"><i class="fa fa-check"></i><b>4</b> Examples</a><ul>
<li class="chapter" data-level="4.1" data-path="examples.html"><a href="examples.html#bar-plot"><i class="fa fa-check"></i><b>4.1</b> Bar plot</a></li>
<li class="chapter" data-level="4.2" data-path="examples.html"><a href="examples.html#line-plot"><i class="fa fa-check"></i><b>4.2</b> Line plot</a></li>
<li class="chapter" data-level="4.3" data-path="examples.html"><a href="examples.html#box-plot"><i class="fa fa-check"></i><b>4.3</b> Box plot</a></li>
<li class="chapter" data-level="4.4" data-path="examples.html"><a href="examples.html#scatter-plot"><i class="fa fa-check"></i><b>4.4</b> Scatter plot</a></li>
<li class="chapter" data-level="4.5" data-path="examples.html"><a href="examples.html#profiles"><i class="fa fa-check"></i><b>4.5</b> Profiles</a><ul>
<li class="chapter" data-level="4.5.1" data-path="examples.html"><a href="examples.html#temperature-profiles"><i class="fa fa-check"></i><b>4.5.1</b> Temperature profiles</a></li>
<li class="chapter" data-level="4.5.2" data-path="examples.html"><a href="examples.html#timeseries"><i class="fa fa-check"></i><b>4.5.2</b> Timeseries</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="examples.html"><a href="examples.html#map"><i class="fa fa-check"></i><b>4.6</b> Map</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="conclusions.html"><a href="conclusions.html"><i class="fa fa-check"></i><b>5</b> Conclusions</a><ul>
<li class="chapter" data-level="5.1" data-path="conclusions.html"><a href="conclusions.html#extensions"><i class="fa fa-check"></i><b>5.1</b> Extensions</a><ul>
<li class="chapter" data-level="5.1.1" data-path="conclusions.html"><a href="conclusions.html#plotly"><i class="fa fa-check"></i><b>5.1.1</b> plotly</a></li>
<li class="chapter" data-level="5.1.2" data-path="conclusions.html"><a href="conclusions.html#gganimate"><i class="fa fa-check"></i><b>5.1.2</b> gganimate</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="conclusions.html"><a href="conclusions.html#recommendations"><i class="fa fa-check"></i><b>5.2</b> Recommendations</a></li>
<li class="chapter" data-level="5.3" data-path="conclusions.html"><a href="conclusions.html#getting-help"><i class="fa fa-check"></i><b>5.3</b> Getting help</a></li>
<li class="chapter" data-level="5.4" data-path="conclusions.html"><a href="conclusions.html#the-end"><i class="fa fa-check"></i><b>5.4</b> The end</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ggplot2 for ocean data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="examples" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Examples</h1>
<p>Using <strong>ggplot2</strong> is very different from most other plotting packages, and can be a lot to take in at first. I think the best way to wrap your head around it is to see it applied in a variety of ways, and of course try to do it yourself. Let’s work through a few more common types of plots.</p>
<div id="bar-plot" class="section level2">
<h2><span class="header-section-number">4.1</span> Bar plot</h2>
<p>Here’s the bar plot produced during the previous example.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw">ggplot</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">data =</span> df, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x=</span>date,<span class="dt">y=</span>n,<span class="dt">fill=</span>species), <span class="dt">color =</span> <span class="st">&#39;black&#39;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&#39;fin&#39;</span> =<span class="st"> &#39;grey&#39;</span>, </a>
<a class="sourceLine" id="cb16-4" data-line-number="4">                               <span class="st">&#39;humpback&#39;</span> =<span class="st"> &#39;blue&#39;</span>, </a>
<a class="sourceLine" id="cb16-5" data-line-number="5">                               <span class="st">&#39;right&#39;</span> =<span class="st"> &#39;red&#39;</span>, </a>
<a class="sourceLine" id="cb16-6" data-line-number="6">                               <span class="st">&#39;sei&#39;</span> =<span class="st"> &#39;darkslategrey&#39;</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">50</span>), <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">50</span>,<span class="dv">5</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb16-8" data-line-number="8"><span class="st">  </span><span class="kw">scale_x_date</span>(<span class="dt">date_breaks =</span> <span class="st">&#39;3 day&#39;</span>, <span class="dt">date_labels =</span> <span class="st">&#39;%b %d&#39;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb16-9" data-line-number="9"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="st">&#39;Detections per day&#39;</span>, <span class="dt">fill =</span> <span class="st">&#39;Species&#39;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb16-10" data-line-number="10"><span class="st">  </span><span class="kw">theme_classic</span>()</a></code></pre></div>
<p><img src="ggplot2_tutorial_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
</div>
<div id="line-plot" class="section level2">
<h2><span class="header-section-number">4.2</span> Line plot</h2>
<p>Here’s an example of using a line plot to display the same data as plotted above. Note the many similarities to the previous plot. The main differences here are in the geometries used, and the coloring aesthetics.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> df, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x=</span>date, <span class="dt">y=</span>n, <span class="dt">color=</span>species, <span class="dt">group=</span>species))<span class="op">+</span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_path</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&#39;fin&#39;</span> =<span class="st"> &#39;grey&#39;</span>, </a>
<a class="sourceLine" id="cb17-5" data-line-number="5">                               <span class="st">&#39;humpback&#39;</span> =<span class="st"> &#39;blue&#39;</span>, </a>
<a class="sourceLine" id="cb17-6" data-line-number="6">                               <span class="st">&#39;right&#39;</span> =<span class="st"> &#39;red&#39;</span>, </a>
<a class="sourceLine" id="cb17-7" data-line-number="7">                               <span class="st">&#39;sei&#39;</span> =<span class="st"> &#39;darkslategrey&#39;</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb17-8" data-line-number="8"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">50</span>), <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">50</span>,<span class="dv">5</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb17-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_x_date</span>(<span class="dt">date_breaks =</span> <span class="st">&#39;3 day&#39;</span>, <span class="dt">date_labels =</span> <span class="st">&#39;%b %d&#39;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb17-10" data-line-number="10"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="st">&#39;Detections per day&#39;</span>, <span class="dt">color =</span> <span class="st">&#39;Species&#39;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb17-11" data-line-number="11"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="ggplot2_tutorial_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
</div>
<div id="box-plot" class="section level2">
<h2><span class="header-section-number">4.3</span> Box plot</h2>
<p>Here’s a simple box plot, which relies on <strong>ggplot2</strong> to compute some summary statistics ‘under the hood’. These are described in some detail in the <code>geom_boxplot()</code> documentation.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw">ggplot</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">data =</span> df, <span class="kw">aes</span>(<span class="dt">x =</span> species, <span class="dt">y =</span> n))<span class="op">+</span></a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;Species&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;Detections per day&#39;</span>)</a></code></pre></div>
<p><img src="ggplot2_tutorial_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>If you do not want to rely upon ggplot to compute summary statistics, you can build them yourself prior to plotting. The key to that is using the <code>stat='indentity</code> argument in <code>geom_boxplot()</code>. Here’s an example of how one might to do that.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(species) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="st">  </span><span class="kw">summarize</span>(</a>
<a class="sourceLine" id="cb19-4" data-line-number="4">    <span class="dt">ymax =</span> <span class="kw">quantile</span>(n,.<span class="dv">95</span>),</a>
<a class="sourceLine" id="cb19-5" data-line-number="5">    <span class="dt">upper =</span> <span class="kw">quantile</span>(n,.<span class="dv">75</span>),</a>
<a class="sourceLine" id="cb19-6" data-line-number="6">    <span class="dt">middle =</span> <span class="kw">quantile</span>(n, <span class="fl">0.5</span>),</a>
<a class="sourceLine" id="cb19-7" data-line-number="7">    <span class="dt">lower =</span> <span class="kw">quantile</span>(n,.<span class="dv">25</span>),</a>
<a class="sourceLine" id="cb19-8" data-line-number="8">    <span class="dt">ymin =</span> <span class="kw">quantile</span>(n,.<span class="dv">05</span>)</a>
<a class="sourceLine" id="cb19-9" data-line-number="9">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-10" data-line-number="10"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> species,</a>
<a class="sourceLine" id="cb19-11" data-line-number="11">           <span class="dt">ymin =</span> ymin, </a>
<a class="sourceLine" id="cb19-12" data-line-number="12">           <span class="dt">lower =</span> lower, </a>
<a class="sourceLine" id="cb19-13" data-line-number="13">           <span class="dt">middle =</span> middle, </a>
<a class="sourceLine" id="cb19-14" data-line-number="14">           <span class="dt">upper =</span> upper, </a>
<a class="sourceLine" id="cb19-15" data-line-number="15">           <span class="dt">ymax =</span> ymax))<span class="op">+</span></a>
<a class="sourceLine" id="cb19-16" data-line-number="16"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">stat =</span> <span class="st">&#39;identity&#39;</span>)</a></code></pre></div>
<p><img src="ggplot2_tutorial_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>Note how I was able to pipe directly from the summary statistics into the ggplot without writing the data to an intermediate variable. That’s not necessary, but can be useful shorthand.</p>
</div>
<div id="scatter-plot" class="section level2">
<h2><span class="header-section-number">4.4</span> Scatter plot</h2>
<p>For the next few plots we’ll be switching over to plotting data from ocean gliders. This is a simple temperature-salinity diagram, which is essentially a scatter plot for visualizing water mass physics. In this case I’ve decided to color the points by the density of the water.</p>
<p>This is similar to what we’ve seen before. I have used the <code>scale_color_viridis_c()</code> to switch from the default ggplot colormap to a nice, perceptually uniform viridis colormap. I also am making the colorbar taller with the argument <code>guide = guide_colourbar(barheight = 15)</code>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="co"># read in ocean glider data</span></a>
<a class="sourceLine" id="cb20-2" data-line-number="2">gld =<span class="st"> </span><span class="kw">readRDS</span>(<span class="kw">url</span>(<span class="st">&#39;https://hansenjohnson.org/files/data/glider.rds&#39;</span>))</a>
<a class="sourceLine" id="cb20-3" data-line-number="3"></a>
<a class="sourceLine" id="cb20-4" data-line-number="4"><span class="co"># plot</span></a>
<a class="sourceLine" id="cb20-5" data-line-number="5"><span class="kw">ggplot</span>(<span class="dt">data=</span>gld, <span class="kw">aes</span>(<span class="dt">y =</span> temperature, <span class="dt">x =</span> salinity, <span class="dt">color =</span> density))<span class="op">+</span></a>
<a class="sourceLine" id="cb20-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">16</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb20-7" data-line-number="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&#39;Temperature (C)&#39;</span>, <span class="dt">x =</span> <span class="st">&#39;Salinity (psu)&#39;</span>, <span class="dt">color =</span> <span class="st">&#39;Density (kg/m3)&#39;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb20-8" data-line-number="8"><span class="st">  </span><span class="kw">scale_color_viridis_c</span>(<span class="dt">guide =</span> <span class="kw">guide_colourbar</span>(<span class="dt">barheight =</span> <span class="dv">15</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb20-9" data-line-number="9"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="ggplot2_tutorial_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="profiles" class="section level2">
<h2><span class="header-section-number">4.5</span> Profiles</h2>
<div id="temperature-profiles" class="section level3">
<h3><span class="header-section-number">4.5.1</span> Temperature profiles</h3>
<p>Here I’m going to plot vertical glider profiles. The first new things here is the <code>scale_y_reverse()</code> function, which simply reverses the y axis direction. The other, incredibly powerful feature I’m showing here is the <code>facet_wrap()</code> function. This effectively creates separate subplots for each category of the facetting variable (in this case <code>profile_id</code>).</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw">ggplot</span>(gld, <span class="kw">aes</span>(<span class="dt">x=</span>temperature,<span class="dt">y=</span>pressure,<span class="dt">group=</span>profile_id))<span class="op">+</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_path</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb21-3" data-line-number="3"><span class="st">  </span><span class="kw">scale_y_reverse</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb21-4" data-line-number="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;Temperature (C)&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;Pressure (dbar)&#39;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb21-5" data-line-number="5"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>profile_id)<span class="op">+</span></a>
<a class="sourceLine" id="cb21-6" data-line-number="6"><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb21-7" data-line-number="7"><span class="st">  </span><span class="kw">theme</span>()</a></code></pre></div>
<p><img src="ggplot2_tutorial_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
</div>
<div id="timeseries" class="section level3">
<h3><span class="header-section-number">4.5.2</span> Timeseries</h3>
<p>These profiles can also be viewed as a timeseries. The main new things here is that I’ve done some formatting to rotate and center the title of the colorbar.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw">ggplot</span>(gld, <span class="kw">aes</span>(<span class="dt">x=</span>time,<span class="dt">y=</span>pressure,<span class="dt">color=</span>temperature))<span class="op">+</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb22-3" data-line-number="3"><span class="st">  </span><span class="kw">scale_y_reverse</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb22-4" data-line-number="4"><span class="st">  </span><span class="kw">scale_x_datetime</span>(<span class="dt">position =</span> <span class="st">&#39;top&#39;</span>, <span class="dt">date_breaks =</span> <span class="st">&#39;3 hours&#39;</span>, <span class="dt">date_labels =</span> <span class="st">&#39;%H:%M&#39;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb22-5" data-line-number="5"><span class="st">  </span><span class="kw">scale_color_viridis_c</span>(</a>
<a class="sourceLine" id="cb22-6" data-line-number="6">    <span class="dt">guide =</span> <span class="kw">guide_colourbar</span>(<span class="dt">barheight =</span> <span class="dv">15</span>,</a>
<a class="sourceLine" id="cb22-7" data-line-number="7">                            <span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">90</span>),</a>
<a class="sourceLine" id="cb22-8" data-line-number="8">                            <span class="dt">title.position =</span> <span class="st">&#39;right&#39;</span>, </a>
<a class="sourceLine" id="cb22-9" data-line-number="9">                            <span class="dt">title.hjust =</span> <span class="fl">0.5</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb22-10" data-line-number="10"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;Time&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;Pressure (dbar)&#39;</span>, <span class="dt">color =</span> <span class="st">&#39;Temperature (C)&#39;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb22-11" data-line-number="11"><span class="st">  </span><span class="kw">theme_classic</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb22-12" data-line-number="12"><span class="st">  </span><span class="kw">theme</span>()</a></code></pre></div>
<p><img src="ggplot2_tutorial_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
</div>
</div>
<div id="map" class="section level2">
<h2><span class="header-section-number">4.6</span> Map</h2>
<p>Mapping requires using several datasets and plotting geometries. It can be complicated, but it’s all still the same <strong>ggplot2</strong> grammar. Here I’m using <code>geom_polygon()</code> to plot the coastline, <code>geom_contour()</code> to add a depth contour, <code>geom_path()</code> to draw the glider track and <code>geom_point()</code> to add the whale detections. The order here matters. Things added later will be plotted on top of things added earlier. The other important new concept here is the <code>coord_quickmap()</code>. The <code>coord_*()</code> functions allow you to access and alter the underlying coordinate system that ggplot is using to render your geometry. Using <code>coord_quickmap()</code> is a quick approximation of a spherical map projection. I’d recommend switching over to <code>coord_map()</code> in situations where you want a more accurate projection, and are prepared to wait for it.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="co"># positions of whale detection</span></a>
<a class="sourceLine" id="cb23-2" data-line-number="2">det =<span class="st"> </span><span class="kw">readRDS</span>(<span class="kw">url</span>(<span class="st">&#39;https://hansenjohnson.org/files/data/detections_all.rds&#39;</span>))</a>
<a class="sourceLine" id="cb23-3" data-line-number="3"></a>
<a class="sourceLine" id="cb23-4" data-line-number="4"><span class="co"># trackline of detection platform</span></a>
<a class="sourceLine" id="cb23-5" data-line-number="5">trk =<span class="st"> </span><span class="kw">readRDS</span>(<span class="kw">url</span>(<span class="st">&#39;https://hansenjohnson.org/files/data/detections_track.rds&#39;</span>))</a>
<a class="sourceLine" id="cb23-6" data-line-number="6"></a>
<a class="sourceLine" id="cb23-7" data-line-number="7"><span class="co"># coastline data</span></a>
<a class="sourceLine" id="cb23-8" data-line-number="8">bg =<span class="st"> </span><span class="kw">readRDS</span>(<span class="kw">url</span>(<span class="st">&#39;https://hansenjohnson.org/files/data/coastline.rds&#39;</span>))</a>
<a class="sourceLine" id="cb23-9" data-line-number="9"></a>
<a class="sourceLine" id="cb23-10" data-line-number="10"><span class="co"># bathymetry data</span></a>
<a class="sourceLine" id="cb23-11" data-line-number="11">bf =<span class="st"> </span><span class="kw">readRDS</span>(<span class="kw">url</span>(<span class="st">&#39;https://hansenjohnson.org/files/data/gg_bathy.rds&#39;</span>))</a>
<a class="sourceLine" id="cb23-12" data-line-number="12"></a>
<a class="sourceLine" id="cb23-13" data-line-number="13"><span class="co"># make plot</span></a>
<a class="sourceLine" id="cb23-14" data-line-number="14"><span class="kw">ggplot</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb23-15" data-line-number="15"><span class="st">  </span></a>
<a class="sourceLine" id="cb23-16" data-line-number="16"><span class="st">  </span><span class="co"># add 100m contour</span></a>
<a class="sourceLine" id="cb23-17" data-line-number="17"><span class="st">  </span><span class="kw">geom_contour</span>(<span class="dt">data =</span> bf, </a>
<a class="sourceLine" id="cb23-18" data-line-number="18">               <span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y, <span class="dt">z=</span>z),</a>
<a class="sourceLine" id="cb23-19" data-line-number="19">               <span class="dt">breaks=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>),</a>
<a class="sourceLine" id="cb23-20" data-line-number="20">               <span class="dt">size=</span><span class="kw">c</span>(<span class="fl">0.3</span>),</a>
<a class="sourceLine" id="cb23-21" data-line-number="21">               <span class="dt">colour=</span><span class="st">&quot;grey&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb23-22" data-line-number="22"><span class="st">  </span></a>
<a class="sourceLine" id="cb23-23" data-line-number="23"><span class="st">  </span><span class="co"># add coastline</span></a>
<a class="sourceLine" id="cb23-24" data-line-number="24"><span class="st">  </span><span class="kw">geom_polygon</span>(<span class="dt">data =</span> bg, <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">group =</span> group), </a>
<a class="sourceLine" id="cb23-25" data-line-number="25">               <span class="dt">fill =</span> <span class="st">&quot;darkgrey&quot;</span>, <span class="dt">color =</span> <span class="ot">NA</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb23-26" data-line-number="26"><span class="st">  </span></a>
<a class="sourceLine" id="cb23-27" data-line-number="27"><span class="st">  </span><span class="co"># add tracks and detections</span></a>
<a class="sourceLine" id="cb23-28" data-line-number="28"><span class="st">  </span><span class="kw">geom_path</span>(<span class="dt">data =</span> trk, <span class="kw">aes</span>(<span class="dt">x=</span>lon,<span class="dt">y=</span>lat), <span class="dt">alpha =</span> <span class="fl">0.7</span>, <span class="dt">color =</span> <span class="st">&#39;blue&#39;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb23-29" data-line-number="29"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> det, <span class="kw">aes</span>(<span class="dt">x=</span>lon,<span class="dt">y=</span>lat), <span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">alpha =</span> <span class="fl">0.7</span>, <span class="dt">fill =</span> <span class="st">&#39;red&#39;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb23-30" data-line-number="30"><span class="st">  </span></a>
<a class="sourceLine" id="cb23-31" data-line-number="31"><span class="st">  </span><span class="co"># configure projection and plot domain</span></a>
<a class="sourceLine" id="cb23-32" data-line-number="32"><span class="st">  </span><span class="kw">coord_quickmap</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">66</span>, <span class="fl">-64.75</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="fl">42.5</span>, <span class="fl">43.5</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb23-33" data-line-number="33"><span class="st">  </span></a>
<a class="sourceLine" id="cb23-34" data-line-number="34"><span class="st">  </span><span class="co"># facet by species</span></a>
<a class="sourceLine" id="cb23-35" data-line-number="35"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>species)<span class="op">+</span></a>
<a class="sourceLine" id="cb23-36" data-line-number="36"><span class="st">  </span></a>
<a class="sourceLine" id="cb23-37" data-line-number="37"><span class="st">  </span><span class="co"># formatting</span></a>
<a class="sourceLine" id="cb23-38" data-line-number="38"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb23-39" data-line-number="39"><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb23-40" data-line-number="40"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="ggplot2_tutorial_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="getting-started.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="conclusions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["ggplot2_tutorial.pdf", "ggplot2_tutorial.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
